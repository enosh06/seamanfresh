import{c as w,b as k,n as C,d as F,r as o,l as P,j as e,o as S,h as z,f as _}from"./index-DV_jiJgy.js";import{C as m}from"./circle-check-big-BGv20riU.js";import{T as q}from"./truck-C1a2fmOt.js";const $=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],A=w("credit-card",$),T=()=>{const{cart:l,subtotal:n,clearCart:h}=k(),{user:u}=C(),{isWholesale:g}=F(),[t,p]=o.useState(u?.address||""),[c,i]=o.useState(!1),[y,f]=o.useState(!1),b=P(),d=s=>{if(g){const a=s.wholesale_moq||0;if(s.quantity>=a)return s.wholesale_price?parseFloat(s.wholesale_price):parseFloat(s.price)*.8}return parseFloat(s.price)},j=async s=>{s.preventDefault(),i(!0);try{const a=localStorage.getItem("token"),N={items:l.map(r=>({product_id:r.id,quantity:r.quantity,price:d(r)})),total_amount:n,delivery_address:t};await z.post(`${_}/api/orders`,N,{headers:{Authorization:`Bearer ${a}`}}),f(!0);const v="/seaman-fresh-final/notification.mp3",x=new Audio(v);x.volume=.8,x.play().catch(r=>console.log("Audio play blocked by browser:",r)),h(),setTimeout(()=>{b("/dashboard")},3e3)}catch(a){console.error(a),alert("Order failed. Please try again.")}finally{i(!1)}};return y?e.jsx("div",{className:"min-h-screen bg-surface flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-12 text-center max-w-lg w-full transform animate-fade-in-up",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(m,{size:48,className:"text-green-500"})}),e.jsx("h2",{className:"text-3xl font-display font-bold text-midnight mb-4",children:"Order Confirmed!"}),e.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"Thank you for choosing Seaman Fresh. Your premium seafood is being prepared and will be on its way to you soon."}),e.jsxs("div",{className:"inline-flex items-center gap-2 text-ocean font-semibold",children:[e.jsx("div",{className:"w-2 h-2 bg-ocean rounded-full animate-bounce"}),"Redirecting to dashboard..."]})]})}):e.jsx("div",{className:"min-h-screen bg-surface py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-midnight mb-2",children:"Checkout"}),e.jsx("p",{className:"text-gray-500",children:"Securely finalize your order"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-ocean/10 rounded-xl",children:e.jsx(q,{className:"text-ocean",size:24})}),e.jsx("h3",{className:"text-xl font-display font-bold text-gray-800",children:"Delivery Information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Delivery Address"}),e.jsx("textarea",{value:t,onChange:s=>p(s.target.value),className:"w-full p-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-ocean focus:border-transparent transition-all resize-none bg-gray-50",rows:"3",placeholder:"Enter your full delivery address...",required:!0}),e.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Fast & Fresh Delivery"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-ocean/10 rounded-xl",children:e.jsx(A,{className:"text-ocean",size:24})}),e.jsx("h3",{className:"text-xl font-display font-bold text-gray-800",children:"Payment Method"})]}),e.jsxs("label",{className:"relative flex items-center p-4 border-2 border-ocean bg-ocean/5 rounded-xl cursor-pointer transition-all hover:bg-ocean/10",children:[e.jsx("input",{type:"radio",checked:!0,readOnly:!0,className:"w-5 h-5 text-ocean focus:ring-ocean"}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("span",{className:"block font-bold text-gray-800",children:"Cash on Delivery"}),e.jsx("span",{className:"block text-sm text-gray-500",children:"Pay securely when you receive your order"})]}),e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:e.jsx("span",{className:"text-xl font-bold text-ocean",children:"$"})})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 sticky top-24",children:[e.jsx("h3",{className:"text-xl font-display font-bold text-gray-800 mb-6 pb-4 border-b border-gray-100",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:l.map(s=>e.jsxs("div",{className:"flex justify-between items-start py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",s.quantity]})]}),e.jsxs("p",{className:"font-medium text-gray-800",children:["$",(d(s)*s.quantity).toFixed(2)]})]},s.id))}),e.jsxs("div",{className:"border-t border-gray-100 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",n.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Delivery Fee"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Free"})]}),e.jsx("div",{className:"h-px bg-gray-100 my-2"}),e.jsxs("div",{className:"flex justify-between text-xl font-bold text-midnight",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-ocean",children:["$",n.toFixed(2)]})]})]}),e.jsx("button",{onClick:j,disabled:c||!t||l.length===0,className:`w-full mt-8 py-4 rounded-xl font-bold text-white shadow-lg transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2
                                    ${c||!t?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-ocean hover:bg-ocean-dark shadow-ocean/30"}`,children:c?e.jsx("span",{className:"flex items-center gap-2",children:"Processing..."}):e.jsxs(e.Fragment,{children:["Place Order",e.jsx(m,{size:20})]})}),e.jsxs("p",{className:"mt-4 text-xs text-center text-gray-400 flex items-center justify-center gap-1",children:[e.jsx(S,{size:12}),"Secure Checkout Process"]})]})})]})]})})};export{T as default};
